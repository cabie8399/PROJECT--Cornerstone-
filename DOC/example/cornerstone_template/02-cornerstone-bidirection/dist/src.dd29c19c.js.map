{"version":3,"sources":["src/index.js"],"names":["ObservableRectangleRoiTool","cornerstoneTools","LengthTool","name","event","console","log","measurement","window","initModeButtons","nameSpace","buttons","document","querySelectorAll","handleClick","evt","action","dataset","options","mouseButtonMask","convertMouseEventWhichToButtons","which","toolName","forEach","btn","classList","remove","add","preventDefault","stopPropagation","stopImmediatePropagation","addEventListener","_initInterface","baseUrl","_initCornerstone","element","querySelector","init","showSVGCursors","cornerstone","enable","imageIds","stack","currentImageIdIndex","cornerstoneWADOImageLoader","external","dicomParser","cornerstoneMath","Hammer","config","webWorkerPath","taskConfiguration","decodeTask","codecsPath","webWorkerManager","initialize","tabIndex","focus","loadImage","then","image","addStackStateManager","addToolState","displayImage","addTool","setToolActive"],"mappings":"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","file":"src.dd29c19c.js","sourceRoot":"..","sourcesContent":["export default class ObservableRectangleRoiTool extends cornerstoneTools.LengthTool {\n  constructor(name = \"ObservableRectangleRoi\") {\n    super({\n      name,\n      // supportedInteractionTypes: ['Mouse'],\n      // mixins: ['activeOrDisabledBinaryTool'],\n    });\n  }\n\n  createNewMeasurement(event) {\n    console.log(\"New measurement\");\n    const measurement = super.createNewMeasurement(event);\n    window.measurement = measurement;\n    console.log(measurement);\n    return measurement;\n  }\n}\n\n\n\nfunction initModeButtons() {\n  const nameSpace = `.mode-buttons`;\n  const buttons = document.querySelectorAll(`${nameSpace} .set-tool-mode`);\n\n  const handleClick = function (evt) {\n    const action = this.dataset.action;\n    const options = {\n      mouseButtonMask: evt.buttons || convertMouseEventWhichToButtons(evt.which)\n    };\n\n    cornerstoneTools[`setTool${action}`](toolName, options);\n\n    // Remove active style from all buttons\n    buttons.forEach((btn) => {\n      btn.classList.remove(\"is-primary\");\n    });\n\n    // Add active style to this button\n    this.classList.add(\"is-primary\");\n\n    evt.preventDefault();\n    evt.stopPropagation();\n    evt.stopImmediatePropagation();\n    return false;\n  };\n\n  buttons.forEach((btn) => {\n    btn.addEventListener(\"contextmenu\", handleClick);\n    btn.addEventListener(\"auxclick\", handleClick);\n    btn.addEventListener(\"click\", handleClick);\n  });\n}\n\nfunction _initInterface() {\n  initModeButtons();\n}\n\n// NOTE: We pull these in from packaged sources in our header,\n// but here are the associated NPM packages that can be used instead\n\n// Packages\n// import Hammer from 'hammerjs';\n// import dicomParser from 'dicom-parser';\n// import * as cornerstone from 'cornerstone-core';\n// import * as cornerstoneMath from 'cornerstone-math';\n// import * as cornerstoneWADOImageLoader from 'cornerstone-wado-image-loader';\n// import * as cornerstoneTools from '@cornerstonejs/tools';\n\nconst baseUrl = \"https://tools.cornerstonejs.org/examples/\";\n\n_initCornerstone();\nconst element = document.querySelector(\".cornerstone-element\");\n_initInterface();\n\n// Init CornerstoneTools\ncornerstoneTools.init({\n  showSVGCursors: true\n});\n\ncornerstone.enable(element);\nconst toolName = \"ObservableRectangleRoi\";\nconst imageIds = [\n  `wadouri:${baseUrl}assets/dicom/exotic/1.dcm`,\n  `wadouri:${baseUrl}assets/dicom/exotic/2.dcm`\n];\n\nconst stack = {\n  currentImageIdIndex: 0,\n  imageIds: imageIds\n};\n\nelement.tabIndex = 0;\nelement.focus();\n\ncornerstone.loadImage(imageIds[0]).then(function (image) {\n  console.log(\"loaded image\");\n  cornerstoneTools.addStackStateManager(element, [\"stack\"]);\n  cornerstoneTools.addToolState(element, \"stack\", stack);\n  cornerstone.displayImage(element, image);\n});\n\n// Add the tool\n// const apiTool = cornerstoneTools[`${toolName}Tool`];\n// cornerstoneTools.addTool(apiTool);\n// Add our tool, and set it's mode\n\n// const BidirectionalTool = cornerstoneTools.BidirectionalTool;\n// cornerstoneTools.addTool(BidirectionalTool)\n// cornerstoneTools.setToolActive('Bidirectional', { mouseButtonMask: 1 })\n\n\n// add custom Tools\ncornerstoneTools.addTool(ObservableRectangleRoiTool);\ncornerstoneTools.setToolActive(\"ObservableRectangleRoi\", {\n  mouseButtonMask: 1\n});\n\n/***************************************************************************\n * UI & Boilerplate setup code\n **************************************************************************/\n\n/***\n *\n *\n */\nfunction _initCornerstone() {\n  // Externals\n  console.log(cornerstoneWADOImageLoader);\n  cornerstoneWADOImageLoader.external.cornerstone = cornerstone;\n  cornerstoneWADOImageLoader.external.dicomParser = dicomParser;\n  cornerstoneTools.external.cornerstoneMath = cornerstoneMath;\n  cornerstoneTools.external.cornerstone = cornerstone;\n  cornerstoneTools.external.Hammer = Hammer;\n\n  // Image Loader\n  const config = {\n    webWorkerPath: `${baseUrl}assets/image-loader/cornerstoneWADOImageLoaderWebWorker.js`,\n    taskConfiguration: {\n      decodeTask: {\n        codecsPath: `${baseUrl}assets/image-loader/cornerstoneWADOImageLoaderCodecs.js`\n      }\n    }\n  };\n  cornerstoneWADOImageLoader.webWorkerManager.initialize(config);\n}\n\nconst convertMouseEventWhichToButtons = (which) => {\n  console.log('146L which ===> ',which);\n  switch (which) {\n    // no button\n    case 0:\n      return 0;\n    // left\n    case 1:\n      return 1;\n    // middle\n    case 2:\n      return 4;\n    // right\n    case 3:\n      return 2;\n  }\n  return 0;\n};\n"]}